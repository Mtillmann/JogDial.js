!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).JogDial=e()}(this,(function(){"use strict";return class{quadrant={current:1,previous:1};rotation={current:0,previous:0};pressed=!1;supportsTouchEvents="ontouchstart"in window;defaults={debug:!1,mode:"knob",angle:0,minAngle:-1/0,maxAngle:1/0,attrPrefix:"jd",cssVarPrefix:"jd",eventPrefix:"jd",roundInputValue:!0,input:null,roundStateValues:!1};domEvent={MOUSE_DOWN:"mousedown",MOUSE_MOVE:"mousemove",MOUSE_OUT:"mouseout",MOUSE_UP:"mouseup"};attrNames={};cssVarNames={};constructor(t,e){if(e={...this.defaults,...e},this.options=e,this.attrNames={attached:`${e.attrPrefix}IsAttached`,debug:`${e.attrPrefix}Debug`,angle:`${e.attrPrefix}Angle`,rotation:`${e.attrPrefix}Rotation`,progress:`${e.attrPrefix}Progress`,percent:`${e.attrPrefix}Percent`},this.cssVarNames={angle:`--${e.attrPrefix}-angle`,rotation:`--${e.attrPrefix}-rotation`,progress:`--${e.attrPrefix}-progress`,percent:`--${e.attrPrefix}-percent`},this.attrNames.attached in t.dataset)return console.error("Please Check your code: JogDial can not be initialized twice in a same element."),!1;this.element=t,this.element.dataset[this.attrNames.attached]="true",this.setupDOM(),this.setupEvents(),this.angleTo(this.convertClockToUnit(this.options.angle))}set(t){const e=this.options.maxAngle||360,s=t>e?e:t;this.angleTo(this.convertClockToUnit(s),s)}setupDOM(){if(this.knob=document.createElement("div"),this.wheel=document.createElement("div"),this.wheel.classList.add("wheel"),this.knob.classList.add("knob"),this.element.appendChild(this.wheel),this.element.appendChild(this.knob),"wheel"===this.options.mode){let t=document.createElement("div");t.classList.add("foreground"),this.element.appendChild(t)}const t=this.knob.clientWidth/2,e=this.wheel.clientWidth/2;this.knob.style.setProperty("margin",-t+"px 0 0 "+-t+"px");const s=(this.element.clientWidth-this.wheel.clientWidth)/2,i=(this.element.clientHeight-this.wheel.clientHeight)/2;this.wheel.style.setProperty("margin",i+"px 0 0 "+s+"px"),this.radius=e-t,this.center={x:e+s,y:e+i},this.options.debug&&(this.element.dataset[this.attrNames.debug]="true"),this.options.input&&this.options.input.addEventListener("input",(t=>{this.set(parseInt(t.target.value))}))}setupEvents(){this.supportsTouchEvents&&(this.domEvent={...this.domEvent,MOUSE_DOWN:"touchstart",MOUSE_MOVE:"touchmove",MOUSE_OUT:"touchleave",MOUSE_UP:"touchend"});const t=t=>{if(this.pressed){t.preventDefault();const e=this.getCoordinates(t),s=e.x-this.center.x+this.wheel.offsetLeft,i=e.y-this.center.y+this.wheel.offsetTop;let n=Math.atan2(i,s)*(180/Math.PI),o=this.getQuadrant(s,i),r=this.convertUnitToClock(n);this.rotation.current=this.getRotation(void 0===o?this.quadrant.previous:o,r);let a=this.rotation.current;this.options.maxAngle!==1/0&&this.options.maxAngle<=a?(a=this.options.maxAngle,n=this.convertClockToUnit(a),r=this.convertUnitToClock(n)):this.options.minAngle!==-1/0&&this.options.minAngle>=a&&(a=this.options.minAngle,n=this.convertClockToUnit(a),r=this.convertUnitToClock(n)),this.setAttributes(a,r),this.angleTo(n)}},e=()=>{this.pressed&&(this.pressed=!1,this.element.dispatchEvent(new CustomEvent(`${this.options.eventPrefix}.end`,{detail:this.getState()})))};this.addEventListeners(this.element,this.domEvent.MOUSE_DOWN,(e=>{switch(this.options.mode){case"knob":default:this.pressed=this.checkBoxCollision({x1:this.knob.offsetLeft-this.wheel.offsetLeft,y1:this.knob.offsetTop-this.wheel.offsetTop,x2:this.knob.offsetLeft-this.wheel.offsetLeft+this.knob.clientWidth,y2:this.knob.offsetTop-this.wheel.offsetTop+this.knob.clientHeight},this.getCoordinates(e));break;case"wheel":this.pressed=!0,t(e)}this.pressed&&this.element.dispatchEvent(new CustomEvent(`${this.options.eventPrefix}.start`,{detail:this.getState()}))}),!1),this.addEventListeners(this.element,this.domEvent.MOUSE_MOVE,t,!1),this.addEventListeners(this.element,this.domEvent.MOUSE_UP,e,!1),this.addEventListeners(this.element,this.domEvent.MOUSE_OUT,e,!1)}angleTo(t,e=!1){t*=Math.PI/180;const s=Math.cos(t)*this.radius+this.center.x,i=Math.sin(t)*this.radius+this.center.y,n=this.getQuadrant(s,i);this.knob.style.setProperty("left",s+"px"),this.knob.style.setProperty("top",i+"px"),void 0===!this.element.dataset.rotation&&this.setAttributes(this.options.angle,this.convertUnitToClock(t)),e&&(this.quadrant.current=n,this.quadrant.previous=n,this.rotation.current=e,this.rotation.previous=e%360,this.setAttributes(e,e%360)),this.element.dispatchEvent(new CustomEvent(`${this.options.eventPrefix}.update`,{detail:this.getState()}))}getState(){return{rotation:parseFloat(this.element.dataset[this.attrNames.rotation]||0),progress:parseFloat(this.element.dataset[this.attrNames.progress]||0),angle:parseFloat(this.element.dataset[this.attrNames.angle]||0),percent:this.element.dataset[this.attrNames.percent]||"0%"}}setAttributes(t,e){let s;s=this.options.maxAngle===1/0?e/360:t/this.options.maxAngle;let i=100*s+"%";this.options.roundStateValues&&(i=Math.round(100*s)+"%",t=Math.round(t),e=Math.round(e)),this.element.dataset[this.attrNames.progress]=s,this.element.style.setProperty(this.cssVarNames.progress,s),this.element.dataset[this.attrNames.percent]=i,this.element.style.setProperty(this.cssVarNames.percent,i),this.element.dataset[this.attrNames.rotation]=t,this.element.style.setProperty(this.cssVarNames.rotation,t+"deg"),this.element.dataset[this.attrNames.angle]=e,this.element.style.setProperty(this.cssVarNames.angle,e+"deg"),this.options.input&&(this.options.input.value=this.options.roundInputValue?Math.round(e):e)}getCoordinates(t){const e=this.wheel.getBoundingClientRect();return{x:(this.supportsTouchEvents?t.targetTouches[0].clientX:t.clientX)-e.left,y:(this.supportsTouchEvents?t.targetTouches[0].clientY:t.clientY)-e.top}}getQuadrant(t,e){return t>0&&e>0?4:t<0&&e>0?3:t<0&&e<0?2:t>=0&&e<0?1:void 0}getRotation(t,e){let s,i=0;return 1===t&&2===this.quadrant.previous?i=360:2===t&&1===this.quadrant.previous&&(i=-360),s=e+i-this.rotation.previous+this.rotation.current,this.rotation.previous=e,this.quadrant.previous=t,s}checkBoxCollision(t,e){return t.x1<e.x&&t.x2>e.x&&t.y1<e.y&&t.y2>e.y}addEventListeners(t,e,s,i){e.split(" ").forEach((e=>t.addEventListener(e,s,i)))}convertClockToUnit(t){return t%360-90}convertUnitToClock(t){return t>=-180&&t<-90?450+t:90+t}}}));