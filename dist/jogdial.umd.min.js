!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).JogDial=e()}(this,(function(){"use strict";return class{quadrant={current:1,previous:1};rotation={current:0,previous:0};pressed=!1;mobileEvent="ontouchstart"in window&&window.navigator.userAgent.match(/Mobile|iP(hone|od|ad)|Android|BlackBerry|IEMobile|Kindle|NetFront|Silk-Accelerated|(hpw|web)OS|Fennec|Minimo|Opera M(obi|ini)|Blazer|Dolfin|Dolphin|Skyfire|Zune/);pointerEvent=!(!window.navigator.pointerEnabled&&!window.navigator.msPointerEnabled);defaults={touchMode:"knob",angle:0,minAngle:-1/0,maxAngle:1/0,attrPrefix:"jd",cssVarPrefix:"jd"};domEvent={MOUSE_DOWN:"mousedown",MOUSE_MOVE:"mousemove",MOUSE_OUT:"mouseout",MOUSE_UP:"mouseup"};attrNames={};cssVarNames={};constructor(t,e){if(e={...this.defaults,...e},this.options=e,this.attrNames={attached:`${e.attrPrefix}IsAttached`,debug:`${e.attrPrefix}Debug`,angle:`${e.attrPrefix}Angle`,rotation:`${e.attrPrefix}Rotation`,progress:`${e.attrPrefix}Progress`,percent:`${e.attrPrefix}Percent`},this.cssVarNames={angle:`--${e.attrPrefix}-angle`,rotation:`--${e.attrPrefix}-rotation`,progress:`--${e.attrPrefix}-progress`,percent:`--${e.attrPrefix}-percent`},this.attrNames.attached in t.dataset)return console.error("Please Check your code: JogDial can not be initialized twice in a same element."),!1;this.element=t,this.element.dataset[this.attrNames.attached]="true",this.setupDOM(),this.setupEvents(),this.angleTo(this.convertClockToUnit(this.options.angle))}set(t){const e=this.options.maxAngle||360,i=t>e?e:t;this.angleTo(this.convertClockToUnit(i),i)}setupDOM(){this.knob=document.createElement("div"),this.wheel=document.createElement("div"),this.knob.classList.add("knob"),this.wheel.classList.add("wheel"),this.element.appendChild(this.knob),this.element.appendChild(this.wheel);const t=this.knob.clientWidth/2,e=this.wheel.clientWidth/2;this.knob.style.setProperty("margin",-t+"px 0 0 "+-t+"px");const i=(this.element.clientWidth-this.wheel.clientWidth)/2,s=(this.element.clientHeight-this.wheel.clientHeight)/2;this.wheel.style.setProperty("margin",s+"px 0 0 "+i+"px"),this.radius=e-t,this.center={x:e+i,y:e+s},this.options.debug&&(this.element.dataset[this.attrNames.debug]="true")}setupEvents(){this.mobileEvent&&(this.domEvent={...this.domEvent,MOUSE_DOWN:"touchstart",MOUSE_MOVE:"touchmove",MOUSE_OUT:"touchleave",MOUSE_UP:"touchend"});const t=t=>{if(this.pressed){t.preventDefault?t.preventDefault():t.returnValue=!1;const e=this.getCoordinates(t),i=e.x-this.center.x+this.wheel.offsetLeft,s=e.y-this.center.y+this.wheel.offsetTop;let n=Math.atan2(s,i)*(180/Math.PI),o=this.getQuadrant(i,s),r=this.convertUnitToClock(n);this.rotation.current=this.getRotation(void 0===o?this.quadrant.previous:o,r);let h=this.rotation.current;this.options.maxAngle!==1/0&&this.options.maxAngle<=h?(h=this.options.maxAngle,n=this.convertClockToUnit(h),r=this.convertUnitToClock(n)):this.options.minAngle!==-1/0&&this.options.minAngle>=h&&(h=this.options.minAngle,n=this.convertClockToUnit(h),r=this.convertUnitToClock(n)),this.setAttributes(h,r),this.angleTo(n)}},e=()=>{this.pressed&&(this.pressed=!1,this.element.dispatchEvent(new CustomEvent("jogdial.end",{detail:this.element.dataset})))};this.addEvent(this.wheel,this.domEvent.MOUSE_DOWN,(e=>{switch(this.options.touchMode){case"knob":default:this.pressed=this.checkBoxCollision({x1:this.knob.offsetLeft-this.wheel.offsetLeft,y1:this.knob.offsetTop-this.wheel.offsetTop,x2:this.knob.offsetLeft-this.wheel.offsetLeft+this.knob.clientWidth,y2:this.knob.offsetTop-this.wheel.offsetTop+this.knob.clientHeight},this.getCoordinates(e));break;case"wheel":this.pressed=!0,t(e)}this.pressed&&this.element.dispatchEvent(new CustomEvent("jogdial.start",{detail:this.element.dataset}))}),!1),this.addEvent(this.wheel,this.domEvent.MOUSE_MOVE,t,!1),this.addEvent(this.wheel,this.domEvent.MOUSE_UP,e,!1),this.addEvent(this.wheel,this.domEvent.MOUSE_OUT,e,!1)}angleTo(t,e=!1){t*=Math.PI/180;const i=Math.cos(t)*this.radius+this.center.x,s=Math.sin(t)*this.radius+this.center.y,n=this.getQuadrant(i,s);this.knob.style.setProperty("left",i+"px"),this.knob.style.setProperty("top",s+"px"),void 0===!this.element.dataset.rotation&&this.setAttributes(this.options.angle,this.convertUnitToClock(t)),e&&(this.quadrant.current=n,this.quadrant.previous=n,this.rotation.current=e,this.rotation.previous=e%360,this.setAttributes(e,e%360)),this.element.dispatchEvent(new CustomEvent("jogdial.update",{detail:this.element.dataset}))}setAttributes(t,e){let i;this.element.dataset.rotation=t,this.element.style.setProperty("--rotation",t+"deg"),this.element.dataset.angle=e,this.element.style.setProperty("--angle",e+"deg"),i=this.options.maxAngle===1/0?e/360:t/this.options.maxAngle;let s=100*i+"%";this.element.dataset.progress=i,this.element.style.setProperty("--progress",i),this.element.dataset.percent=s,this.element.style.setProperty("--percent",s+"deg")}getCoordinates(t){const e=t.target.getBoundingClientRect();return{x:(this.mobileEvent?t.targetTouches[0].clientX:t.clientX)-e.left,y:(this.mobileEvent?t.targetTouches[0].clientY:t.clientY)-e.top}}getQuadrant(t,e){return t>0&&e>0?4:t<0&&e>0?3:t<0&&e<0?2:t>=0&&e<0?1:void 0}getRotation(t,e){let i,s=0;return 1===t&&2===this.quadrant.previous?s=360:2===t&&1===this.quadrant.previous&&(s=-360),i=e+s-this.rotation.previous+this.rotation.current,this.rotation.previous=e,this.quadrant.previous=t,i}checkBoxCollision(t,e){return t.x1<e.x&&t.x2>e.x&&t.y1<e.y&&t.y2>e.y}addEvent(t,e,i,s){e.split(" ").forEach((e=>t.addEventListener(e,i,s)))}convertClockToUnit(t){return t%360-90}convertUnitToClock(t){return t>=-180&&t<-90?450+t:90+t}}}));